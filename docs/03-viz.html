<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Data Visualisation – Applied Data Skills</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-summary.html" rel="next">
<link href="./02-reports.html" rel="prev">
<link href="./images/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-bef06593271c35acc66b6cdfb882565b.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-ea06de1ba525ceca656e3b09b4cd3316.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-bef06593271c35acc66b6cdfb882565b.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-055205720082bea6cf7d6c8b816a8014.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-18a2161c37a28c2ad2b6bf620dd7650e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-055205720082bea6cf7d6c8b816a8014.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6NP3MF25W3', { 'anonymize_ip': true});
</script><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-viz.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Applied Data Skills</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quarto Reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-viz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Summaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-formative.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Practice Report</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Coding with AI</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Relations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Tidying</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-wrangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-custom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Next Steps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License/Citation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Advanced: Websites</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-referencing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Advanced: Referencing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Advanced: Data Import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-datatypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Advanced: Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Advanced: Dates and Times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Advanced: Styling Plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Advanced: Table Formatting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Advanced: More Plots</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-ilo-viz" id="toc-sec-ilo-viz" class="nav-link active" data-scroll-target="#sec-ilo-viz">Intended Learning Outcomes</a></li>
  <li><a href="#sec-functions-viz" id="toc-sec-functions-viz" class="nav-link" data-scroll-target="#sec-functions-viz">Functions used</a></li>
  <li><a href="#sec-setup-viz" id="toc-sec-setup-viz" class="nav-link" data-scroll-target="#sec-setup-viz">Set-up</a></li>
  <li>
<a href="#sec-plots" id="toc-sec-plots" class="nav-link" data-scroll-target="#sec-plots"><span class="header-section-number">3.1</span> Building plots</a>
  <ul class="collapse">
<li><a href="#sec-plots-loading-data" id="toc-sec-plots-loading-data" class="nav-link" data-scroll-target="#sec-plots-loading-data"><span class="header-section-number">3.1.1</span> Loading data</a></li>
  <li><a href="#plot-setup" id="toc-plot-setup" class="nav-link" data-scroll-target="#plot-setup"><span class="header-section-number">3.1.2</span> Plot setup</a></li>
  <li><a href="#multiple-geoms" id="toc-multiple-geoms" class="nav-link" data-scroll-target="#multiple-geoms"><span class="header-section-number">3.1.3</span> Multiple geoms</a></li>
  <li><a href="#plot-objects" id="toc-plot-objects" class="nav-link" data-scroll-target="#plot-objects"><span class="header-section-number">3.1.4</span> Plot objects</a></li>
  <li><a href="#combining-plots" id="toc-combining-plots" class="nav-link" data-scroll-target="#combining-plots"><span class="header-section-number">3.1.5</span> Combining plots</a></li>
  </ul>
</li>
  <li>
<a href="#customising-plots" id="toc-customising-plots" class="nav-link" data-scroll-target="#customising-plots"><span class="header-section-number">3.2</span> Customising plots</a>
  <ul class="collapse">
<li><a href="#styling-geoms" id="toc-styling-geoms" class="nav-link" data-scroll-target="#styling-geoms"><span class="header-section-number">3.2.1</span> Styling geoms</a></li>
  <li><a href="#format-axes" id="toc-format-axes" class="nav-link" data-scroll-target="#format-axes"><span class="header-section-number">3.2.2</span> Format axes</a></li>
  <li><a href="#axis-limits" id="toc-axis-limits" class="nav-link" data-scroll-target="#axis-limits"><span class="header-section-number">3.2.3</span> Axis limits</a></li>
  <li><a href="#sec-themes" id="toc-sec-themes" class="nav-link" data-scroll-target="#sec-themes"><span class="header-section-number">3.2.4</span> Themes</a></li>
  <li><a href="#theme-tweaks" id="toc-theme-tweaks" class="nav-link" data-scroll-target="#theme-tweaks"><span class="header-section-number">3.2.5</span> Theme tweaks</a></li>
  </ul>
</li>
  <li>
<a href="#sec-captions" id="toc-sec-captions" class="nav-link" data-scroll-target="#sec-captions"><span class="header-section-number">3.3</span> Figure captions</a>
  <ul class="collapse">
<li><a href="#sec-ggsave" id="toc-sec-ggsave" class="nav-link" data-scroll-target="#sec-ggsave"><span class="header-section-number">3.3.1</span> Saving Plots</a></li>
  </ul>
</li>
  <li>
<a href="#sec-appropriate-plots" id="toc-sec-appropriate-plots" class="nav-link" data-scroll-target="#sec-appropriate-plots"><span class="header-section-number">3.4</span> Appropriate plots</a>
  <ul class="collapse">
<li><a href="#counting-categories" id="toc-counting-categories" class="nav-link" data-scroll-target="#counting-categories"><span class="header-section-number">3.4.1</span> Counting categories</a></li>
  <li><a href="#pie-chart" id="toc-pie-chart" class="nav-link" data-scroll-target="#pie-chart"><span class="header-section-number">3.4.2</span> Pie chart</a></li>
  <li><a href="#sec-histogram" id="toc-sec-histogram" class="nav-link" data-scroll-target="#sec-histogram"><span class="header-section-number">3.4.3</span> One continuous variable</a></li>
  <li><a href="#grouped-continuous-variables" id="toc-grouped-continuous-variables" class="nav-link" data-scroll-target="#grouped-continuous-variables"><span class="header-section-number">3.4.4</span> Grouped continuous variables</a></li>
  <li><a href="#two-continuous-variables" id="toc-two-continuous-variables" class="nav-link" data-scroll-target="#two-continuous-variables"><span class="header-section-number">3.4.5</span> Two continuous variables</a></li>
  <li><a href="#simulated-data" id="toc-simulated-data" class="nav-link" data-scroll-target="#simulated-data"><span class="header-section-number">3.4.6</span> Simulated data</a></li>
  <li><a href="#overplotting" id="toc-overplotting" class="nav-link" data-scroll-target="#overplotting"><span class="header-section-number">3.4.7</span> Overplotting</a></li>
  </ul>
</li>
  <li><a href="#sec-advanced-plots" id="toc-sec-advanced-plots" class="nav-link" data-scroll-target="#sec-advanced-plots"><span class="header-section-number">3.5</span> Advanced</a></li>
  <li><a href="#sec-exercises-viz" id="toc-sec-exercises-viz" class="nav-link" data-scroll-target="#sec-exercises-viz"><span class="header-section-number">3.6</span> Peer Coding Exercises</a></li>
  <li><a href="#sec-glossary-viz" id="toc-sec-glossary-viz" class="nav-link" data-scroll-target="#sec-glossary-viz">Glossary</a></li>
  <li><a href="#sec-resources-viz" id="toc-sec-resources-viz" class="nav-link" data-scroll-target="#sec-resources-viz">Further Resources</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-viz" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Visualisation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- checked for alt-text --><div class="right meme">
<img src="images/memes/better_graphs.png" alt="xkcd comic titled 'General quality of charts and graphs in scientific papers'; y-axis: BAD on the bottom to GOOD on the top; x-axis: 1950s to 2010s; Line graph increases with time except for a dip between 1990 and 2010 labelled POWERPOINT/MSPAINT ERA">
</div>
<section id="sec-ilo-viz" class="level2 unnumbered ilo"><h2 class="unnumbered ilo anchored" data-anchor-id="sec-ilo-viz">Intended Learning Outcomes</h2>
<ul class="task-list">
<li><label><input type="checkbox">Identify categorical versus continuous data</label></li>
<li><label><input type="checkbox">Create plots in layers using ggplot</label></li>
<li><label><input type="checkbox">Choose appropriate plots for data</label></li>
</ul></section><section id="sec-functions-viz" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="sec-functions-viz">Functions used</h2>
<ul>
<li>built-in (you can always use these without loading any packages)
<ul>
<li>base:: , <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>, <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>, <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code>,</li>
<li>grDevices:: <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code>
</li>
</ul>
</li>
<li>tidyverse (you can use all these with <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>)
<ul>
<li>readr:: <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></code>
</li>
<li>dplyr:: <code><a href="https://dplyr.tidyverse.org/reference/count.html">dplyr::count()</a></code>
</li>
<li>ggplot2:: <code>aes()</code>, <code>coord_cartesian()</code>, <code>element_blank()</code>, <code>facet_wrap()</code>, <code>geom_bar()</code>, <code>geom_boxplot()</code>, <code>geom_col()</code>, <code>geom_histogram()</code>, <code>geom_jitter()</code>, <code>geom_point()</code>, <code>geom_smooth()</code>, <code>ggplot()</code>, <code>ggsave()</code>, <code>ggtitle()</code>, <code>guides()</code>, <code>scale_fill_manual()</code>, <code>scale_x_continuous()</code>, <code>scale_x_discrete()</code>, <code>scale_y_continuous()</code>, <code>spec()</code>, <code>theme()</code>, <code>theme_bw()</code>, <code>theme_minimal()</code>, <code>theme_set()</code>
</li>
</ul>
</li>
<li>other (you need to load each package to use these)
<ul>
<li>ggthemes:: <code><a href="http://jrnold.github.io/ggthemes/reference/theme_gdocs.html">ggthemes::theme_gdocs()</a></code>
</li>
<li>patchwork:: <code><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">patchwork::plot_layout()</a></code>
</li>
</ul>
</li>
</ul></section><section id="sec-setup-viz" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="sec-setup-viz">Set-up</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Open your <code>ADS-2026</code> project</li>
<li>Create a new quarto file called <code>03-dataviz.qmd</code>
</li>
<li>Update the YAML header</li>
<li>Replace the setup chunk with the one below:</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#| label: setup</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#| include: false</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(tidyverse) <span class="co"># includes readr, ggplot2, dplyr, and lubridate</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(patchwork) <span class="co"># for multi-part plots</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(ggthemes)  <span class="co"># for plot themes</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="in">```</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<p>If you get the message <code>Error in library(x) : there is no package called ‘x’</code>, please refer to <a href="01-intro.html#sec-install-package" class="quarto-xref"><span>Section 1.4.1</span></a>.</p>
<p>We’d recommend making a new code chunk for each different activity, and using the white space to make notes on any errors you make, things you find interesting, or questions you’d like to ask the course team.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Download the <a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html">ggplot2 cheat sheet</a>.</p>
</div>
</div>
</section><section id="sec-plots" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="sec-plots">
<span class="header-section-number">3.1</span> Building plots</h2>
<p>There are multiple approaches to data visualisation in R; in this course we will use the popular package <pkg>ggplot2</pkg>, which is part of the larger <pkg>tidyverse</pkg> collection of packages. A grammar of graphics (the “gg” in “ggplot”) is a standardised way to describe the components of a graphic. <pkg>ggplot2</pkg> uses a layered grammar of graphics, in which plots are built up in a series of layers. It may be helpful to think about any plot as having multiple elements that sit semi-transparently over each other. A good analogy is old Disney movies where artists would create a background and then add moveable elements on top of the background via transparencies.</p>
<p><a href="#fig-layers" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> displays the evolution of a simple scatterplot using this layered approach. First, the plot space is built (layer 1); the variables are specified (layer 2); the type of visualisation (known as a <code>geom</code>) that is desired for these variables is specified (layer 3) - in this case <code>geom_point()</code> is called to visualise individual data points; a second geom is added to include a line of best fit (layer 4), the axis labels are edited for readability (layer 5), and finally, a theme is applied to change the overall appearance of the plot (layer 6).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-layers" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A grid of 6 layers buidling up a plot. 1: A blank plot. 2: Adds the x-axis `gini` with ticks 0.3 to 0.6 and the y-axis `welfare_mean` with ticks form 0 to 80. 3: Adds blue scatterplot points. 4: Adds a linear trendline with error shading. 5: Changes the x-axis label to `Gini Index` and the y-axis label to `Mean Welfare (log10)` and the y-axis to a log10 scale with ticks at 3, 10, 30 and 100. 6: Changes the y-axis ticks to 1, 2, 5, 10, 20, 50, and 100." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-layers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-layers-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A grid of 6 layers buidling up a plot. 1: A blank plot. 2: Adds the x-axis `gini` with ticks 0.3 to 0.6 and the y-axis `welfare_mean` with ticks form 0 to 80. 3: Adds blue scatterplot points. 4: Adds a linear trendline with error shading. 5: Changes the x-axis label to `Gini Index` and the y-axis label to `Mean Welfare (log10)` and the y-axis to a log10 scale with ticks at 3, 10, 30 and 100. 6: Changes the y-axis ticks to 1, 2, 5, 10, 20, 50, and 100.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-layers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Evolution of a layered plot
</figcaption></figure>
</div>
</div>
</div>
<p>Importantly, each layer is independent and independently customisable. For example, the size, colour and position of each component can be adjusted, or one could, for example, remove the first geom (the data points) to only visualise the line of best fit, simply by removing the layer that draws the data points (<a href="#fig-remove-layer" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>). The use of layers makes it easy to build up complex plots step-by-step, and to adapt or extend plots from existing code.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-remove-layer" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A regression line with Gini Index on the x-axis and Mean Welfare (log10) on the y-axis, showing a negative relationship from 2.5 gini/30 welfare to 6.5 gini/5 welfare." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-remove-layer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-remove-layer-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A regression line with Gini Index on the x-axis and Mean Welfare (log10) on the y-axis, showing a negative relationship from 2.5 gini/30 welfare to 6.5 gini/5 welfare.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-remove-layer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Final plot with scatterplot layer removed.
</figcaption></figure>
</div>
</div>
</div>
<section id="sec-plots-loading-data" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="sec-plots-loading-data">
<span class="header-section-number">3.1.1</span> Loading data</h3>
<p>Let’s build up the plot above, layer by layer. First we need to get the data. We’ll learn how to load data from different sources in <a href="app-import.html" class="quarto-xref"><span>Appendix C</span></a>, but this time we’ll use the same method as we did in <a href="02-reports.html#sec-loading-online" class="quarto-xref"><span>Section 2.3.3</span></a> and load it from an online source.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Load the data by copying the following into a code block in your script, and running the code.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>pip <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/PsyTeachR/ads-v3/refs/heads/master/data/pip_gini_welfare_2010.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<p>When you load the data, <code>read_csv()</code> will produce a message that gives you information about the data it has imported and what assumptions it has made. The “column specification” tells you what each column is named and what type of data R has categorised each variable as. The abbreviation “chr” is for <a href="https://psyteachr.github.io/glossary/c#character" target="_blank" class="glossary" title="A data type representing strings of text.">character</a> columns, “dbl” is for <a href="https://psyteachr.github.io/glossary/d#double" target="_blank" class="glossary" title="A data type representing a real decimal number">double</a> columns, and “dttm” is a date/time column.</p>
<p>This data is from the World Bank’s <a href="https://pip.worldbank.org/poverty-calculator">Poverty and Inequality Platform</a> (accessed on 2025-08-05).</p>
<p>The first thing you should do when you need to plot data is to get familiar with what all of the rows (observations) and columns (variables) mean. Sometimes this is obvious, and sometimes it requires help from the data provider. Here, each row represents data for one region for one year.</p>
<ul>
<li>
<code>region_name</code> is the name of the world region, like “South Asia”</li>
<li>
<code>region_code</code> is the 3-letter abbreviation for region</li>
<li>
<code>country_name</code> is the name of the country</li>
<li>
<code>country_code</code> is the 3-letter country code</li>
<li>
<code>reporting_year</code> is a year 1963 - 2024</li>
<li>
<code>reporting_level</code> is “national” for this entire dataset</li>
<li>
<code>gini</code> is a measure of inequality that ranges from 0 (perfect equality) to 1 (complete inequality)</li>
<li>
<code>welfare_mean</code> is average welfare per capita (see the <a href="https://datanalytics.worldbank.org/PIP-Methodology/">methodology page</a> for more info on how this is calculated)</li>
<li>
<code>welfare_median</code> is the amount of welfare per capita that divides the distribution into two equal halves</li>
</ul></section><section id="plot-setup" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="plot-setup">
<span class="header-section-number">3.1.2</span> Plot setup</h3>
<section id="default-theme" class="level4" data-number="3.1.2.1"><h4 data-number="3.1.2.1" class="anchored" data-anchor-id="default-theme">
<span class="header-section-number">3.1.2.1</span> Default theme</h4>
<p>Plots in this book use the black-and-white theme, not the default grey theme, so set your default theme to the same so your plots will look like the examples below. At the top of your script, in the setup chunk after you’ve loaded the tidyverse package, add the following code and run it. You’ll learn more ways to customise your theme in <a href="#sec-themes" class="quarto-xref"><span>Section 3.2.4</span></a> and <a href="app-styling.html#sec-themes-appendix" class="quarto-xref"><span>Section F.3</span></a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add this code to your setup chunk. It needs to run before you make the first plot in this script.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()) <span class="co"># set the default theme</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</section><section id="sec-plot-setup-data" class="level4" data-number="3.1.2.2"><h4 data-number="3.1.2.2" class="anchored" data-anchor-id="sec-plot-setup-data">
<span class="header-section-number">3.1.2.2</span> Data</h4>
<p>Every plot starts with the <code>ggplot()</code> function and a data table. If your data are not loaded or you have a typo in your code, this will give you an error message. It’s best to check your plot after each step, so that you can figure out where errors are more easily.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>In a new code chunk, create a blank plot.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pip)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/img-build-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A blank plot"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="mapping" class="level4" data-number="3.1.2.3"><h4 data-number="3.1.2.3" class="anchored" data-anchor-id="mapping">
<span class="header-section-number">3.1.2.3</span> Mapping</h4>
<p>The next <a href="https://psyteachr.github.io/glossary/a#argument" target="_blank" class="glossary" title="A variable that provides input to a function.">argument</a> to <code>ggplot()</code> is the <code>mapping</code>. This tells the plot which columns in the data should be represented by, or “mapped” to, different aspects of the plot, such as the x-axis, y-axis, line colour, object fill, or line style. These aspects, or “aesthetics”, are listed inside the <code>aes()</code> function.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Set the arguments <code>x</code> and <code>y</code> to the names of the columns you want to be plotted on those axes. Here, we want to plot <code>gini</code> (the measure of inequality) on the x-axis and <code>welfare_mean</code> (average welfore per capita) on the y-axis.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># set up the plot with mapping</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">ggplot</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="at">data =</span> pip, </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)</span>
<span id="cb5-5"><a href="#cb5-5"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/img-build-plot-mapping-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="An empty plot with `gini` on the x-axis and `welfare_mean` on the y-axis"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>In the example above, we wrote out the names of the <a href="https://psyteachr.github.io/glossary/a#argument" target="_blank" class="glossary" title="A variable that provides input to a function.">arguments</a> <code>data</code> and <code>mapping</code>, but in practice, almost everyone omits them. Just make sure you put the data and mapping in the right order.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="sec-ggplot-labels" class="level4" data-number="3.1.2.4"><h4 data-number="3.1.2.4" class="anchored" data-anchor-id="sec-ggplot-labels">
<span class="header-section-number">3.1.2.4</span> Label Attributes</h4>
<p>You probably don’t want the axis labels to read “gini” and “welfare_mean”. These are great column labels that fit our rules for naming objects in R (<a href="02-reports.html#sec-naming" class="quarto-xref"><span>Section 2.1.4</span></a>), but are not plot-friendly.</p>
<p>Before ggplot2 version 4.0.0, you had to always manually change the aesthetic labels with <code>labs()</code> or a scale_* function. But now you can add plot-friendly labels directly to the data table so they are always used.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Update the labels for each variable.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># set label attributes</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">attr</span>(pip<span class="sc">$</span>region_name, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">attr</span>(pip<span class="sc">$</span>region_code, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="fu">attr</span>(pip<span class="sc">$</span>country_name, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Country"</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">attr</span>(pip<span class="sc">$</span>country_code, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Country"</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="fu">attr</span>(pip<span class="sc">$</span>reporting_year, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Year"</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="fu">attr</span>(pip<span class="sc">$</span>gini, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Gini Index"</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="fu">attr</span>(pip<span class="sc">$</span>welfare_mean, <span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Mean Welfare per Capita"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>If this doesn’t work, check what version of ggplot2 you’re using with <code>packageVersion("ggplot2")</code>.</p>
</div>
</div>
</section><section id="geoms" class="level4" data-number="3.1.2.5"><h4 data-number="3.1.2.5" class="anchored" data-anchor-id="geoms">
<span class="header-section-number">3.1.2.5</span> Geoms</h4>
<p>Now we can add our plot elements in layers. These are referred to as <a href="https://psyteachr.github.io/glossary/g#geom" target="_blank" class="glossary" title="The geometric style in which data are displayed, such as boxplot, density, or histogram.">geoms</a> and their functions start with <code>geom_</code>. You <strong>add</strong> layers onto the base plot created by <code>ggplot()</code> with a plus (<code>+</code>).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add a scatterplot to your plot using <code>geom_point()</code>. Notice how the axis labels have updated themselves from the label attributes we set above!</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">geom_point</span>() <span class="co"># scatterplot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/img-build-plot-labels-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A plot with axis labels and points"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Location of the +
</div>
</div>
<div class="callout-body-container callout-body">
<p>Somewhat annoyingly, the plus has to be on the end of the previous line, not at the start of the next line. If you do make this mistake, it will run the first line of code to produce the base layer but then you will get the following error message rather than adding on <code>geom_point()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A plot with axis labels, but no scatterplot"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="sc">+</span> <span class="fu">geom_point</span>() <span class="co"># scatterplot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error:
! Cannot use `+` with a single argument.
ℹ Did you accidentally put `+` on a new line?</code></pre>
</div>
</div>
</div>
</div>
</section></section><section id="multiple-geoms" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="multiple-geoms">
<span class="header-section-number">3.1.3</span> Multiple geoms</h3>
<p>Part of the power of <pkg>ggplot2</pkg> is that you can add more than one geom to a plot by adding on extra layers and so it quickly becomes possible to make complex and informative visualisations. Importantly, the layers display in the order you set them up. The code below uses the same geoms to produce a boxplot with the raw data points, but orders them differently.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># points on top of boxplot</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_name, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co"># points underneath boxplot </span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_name, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-build-plot-geom2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two nearly identical plots with boxplots plus raw data points. In the left plot, the points are underneath the boxplot, and in the right plot they are on top." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-geom2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-geom2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Two nearly identical plots with boxplots plus raw data points. In the left plot, the points are underneath the boxplot, and in the right plot they are on top.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-geom2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Points on top vs points underneath
</figcaption></figure>
</div>
</div>
</div>
</section><section id="plot-objects" class="level3" data-number="3.1.4"><h3 data-number="3.1.4" class="anchored" data-anchor-id="plot-objects">
<span class="header-section-number">3.1.4</span> Plot objects</h3>
<p>Just like you can save numbers and data tables to objects, you can also save the output of <code>ggplot()</code>. The code below produces the same plots we created above but saves them to objects named <code>points_top</code> and <code>points_bottom</code>. If you run just this code, the plots won’t display like they have done before. Instead, you’ll see the object names appear in the environment pane.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># points on top of boxplot</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>points_top <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_name, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># points underneath boxplot </span></span>
<span id="cb13-8"><a href="#cb13-8"></a>points_bottom <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_name, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To view the plots, call the objects by name. This will output each plot separately.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>points_top <span class="co"># view first plot</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>points_bottom <span class="co"># view second plot</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Save your two plots to objects with appropriate names and then view them.</p>
</div>
</div>
</section><section id="combining-plots" class="level3" data-number="3.1.5"><h3 data-number="3.1.5" class="anchored" data-anchor-id="combining-plots">
<span class="header-section-number">3.1.5</span> Combining plots</h3>
<p>One of the reasons to save your plots to objects is so that you can combine multiple plots using functions from the <code>patchwork</code> package. The code below produces the plot above by combining the two plots with <code>+</code> and then specifying that we want the plots produced on a single row with the <code>nrow</code> argument in <code>plot_layout()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># add plots together in 1 row</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>points_top <span class="sc">+</span> points_bottom <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-geom2b" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The points_top and points_bottom plots displayed in one image side-by-side." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-geom2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-geom2b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The points_top and points_bottom plots displayed in one image side-by-side.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-geom2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Combining plots with patchwork.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Combine your plots using <code>plot_layout()</code>.</li>
<li>Try changing the value of <code>nrow</code> to 2.</li>
<li>Add the argument <code>axes = "collect"</code> to <code>plot_layout()</code>. Use the help documentation for additional explanation on what it does.</li>
</ol>
</div>
</div>
<p>The <a href="https://patchwork.data-imaginist.com/articles/guides/layout.html"><code>patchwork</code> documentation</a> has some great resources and examples of all the different ways in which you can adjust the layout when you combine multiple plots.</p>
</section></section><section id="customising-plots" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="customising-plots">
<span class="header-section-number">3.2</span> Customising plots</h2>
<p>There are nearly endless ways to customise ggplots. We’ll cover a few of the basic customisations here.</p>
<section id="styling-geoms" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="styling-geoms">
<span class="header-section-number">3.2.1</span> Styling geoms</h3>
<p>For our scatterplot, We should definitely put the line in front of the points, but the points are still a bit dark. If you want to change the overall style of a geom, you can set the arguments <code>colour</code>, <code>alpha</code>, <code>shape</code>, <code>size</code> and <code>linetype</code> inside the geom function. There are many different values that you can set these to; <a href="app-styling.html" class="quarto-xref"><span>Appendix F</span></a> gives details of these.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb16-3"><a href="#cb16-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="co"># 20% transparency</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>             <span class="at">shape =</span> <span class="dv">18</span>,  <span class="co"># solid diamond</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="co"># setting method &amp; formula avoids an annoying message</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,   <span class="co"># method of linear model (lm)</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="co"># formula used to draw line</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>),</span>
<span id="cb16-10"><a href="#cb16-10"></a>              <span class="at">linetype =</span> <span class="dv">3</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-style" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The same scatter-line plot as above, but the points are transparent blue diamonds instead of solid black circles, and the regression line is dotted and blue instead of solid and blue." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-style-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-style-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The same scatter-line plot as above, but the points are transparent blue diamonds instead of solid black circles, and the regression line is dotted and blue instead of solid and blue.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-style-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Changing geom styles.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Play around with different values above and figure out what the <a href="https://psyteachr.github.io/glossary/d#default-value" target="_blank" class="glossary" title="A value that a function uses for an argument if it is skipped.">default values</a> are for <code>shape</code> and <code>size</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Setting aesthetics overall versus by category
</div>
</div>
<div class="callout-body-container callout-body">
<p>This method is only for changing the style of <em>all</em> the shapes made with that geom. If you want, for example, points to have different colours depending on which region they are from, you set the argument <code>colour = region</code> inside the <code>aes()</code> function for the mapping. You can customise the colours used with <code>scale_</code> functions, which you will learn about below and in <a href="app-styling.html" class="quarto-xref"><span>Appendix F</span></a>.</p>
</div>
</div>
</section><section id="format-axes" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="format-axes">
<span class="header-section-number">3.2.2</span> Format axes</h3>
<p>Now we need to make the axes look neater. There are several functions you can use to change the axis labels, but the most powerful ones are the <code>scale_</code> functions. You need to use a scale function that matches the data you’re plotting on that axis and this is where it becomes particularly important to know what type of data you’re working with. Both of the axes here are <a href="https://psyteachr.github.io/glossary/c#continuous" target="_blank" class="glossary" title="Data that can take on any values between other existing values.">continuous</a>, so we’ll use <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb17-3"><a href="#cb17-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb17-5"><a href="#cb17-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb17-6"><a href="#cb17-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="co"># customise axis labels and breaks</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-axes" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The same scatter-line plot as above, but the points are transparent blue circles, and the regression line is a solid blue." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-axes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-axes-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The same scatter-line plot as above, but the points are transparent blue circles, and the regression line is a solid blue.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-axes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Formatting plot axes with scale_ functions.
</figcaption></figure>
</div>
</div>
</div>
<p>The <code>name</code> argument changes the axis label. The <code>breaks</code> argument sets the major units and needs a <a href="https://psyteachr.github.io/glossary/v#vector" target="_blank" class="glossary" title="A type of data structure that collects values with the same data type, like T/F values, numbers, or strings.">vector</a> of possible values, which can extend beyond the range of the data (e.g., <code>gini</code> values in this set are only between 0.2 and 0.7, but we can specify breaks 0-1 to make the maths easier or anticipate updates to the data). The <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> function creates a sequence of numbers <code>from</code> one <code>to</code> another <code>by</code> specified steps.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Set the y-axis name to “Mean Welfare per Capita” and the breaks to every 20 with minor breaks every 5. Check the help for <code>?scale_y_continuous</code> to see how you would set the minor units.</p>
</div>
</div>
<div class="cell" data-layout-align="center" data-webex.hide="true">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb20-3"><a href="#cb20-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb20-5"><a href="#cb20-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb20-6"><a href="#cb20-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="co"># customise axis labels and breaks</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>),    </span>
<span id="cb20-10"><a href="#cb20-10"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/img-scale-y-continuous-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The plot above with the x-axis labelled 'Gini Index' and breaks at 0.3, 0.4, 0.5, and 0.6, and the y-axis labelled 'Mean Welfare per Capita' and breaks at 0, 20, 40, 60, and 80."></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="axis-limits" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="axis-limits">
<span class="header-section-number">3.2.3</span> Axis limits</h3>
<p>If you want to change the minimum and maximum values on an axis, use the <code>coord_cartesian()</code> function. Many plots make more sense if the minimum and maximum values represent the range of possible values, even if those values aren’t present in the data. Here, the mean_welfare ranges between 0 and 100.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb21-3"><a href="#cb21-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb21-5"><a href="#cb21-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb21-6"><a href="#cb21-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>),    </span>
<span id="cb21-9"><a href="#cb21-9"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="co"># set axis limits</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-limits" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The plot above with the x-axis from 0 to 100." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-limits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-limits-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The plot above with the x-axis from 0 to 100.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-limits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Changing the axis limits.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Update the ylim limits of <code>mean_welfare</code> as above.</li>
<li>Then, update the xlim of <code>gini</code> according to their minimum and maximum values (these were described earlier). This plot looks quite strange and we wouldn’t recommend this is how you present the data, but consider the story it tells and how it might change your interpretation.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Setting limits with the scale_ function
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also set the <code>limits</code> argument inside the <code>scale_</code> functions, but this actually removes any data that falls outside these limits, rather than cropping your plot, and this can change the appearance of certain types of plots like violin plots and density plots.</p>
</div>
</div>
</section><section id="sec-themes" class="level3" data-number="3.2.4"><h3 data-number="3.2.4" class="anchored" data-anchor-id="sec-themes">
<span class="header-section-number">3.2.4</span> Themes</h3>
<p><pkg>ggplot2</pkg> comes with several built-in themes, such as <code>theme_minimal()</code> and <code>theme_bw()</code>, but the <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/"><pkg>ggthemes</pkg></a> package provides even more themes to match different software, such as GoogleDocs or Stata, or publications, such as the Economist or the Wall Street Journal. Let’s add the light theme, but change the font size to 11 with the <code>base_size</code> argument.</p>
<p>It’s also worth highlighting that this code is starting to look quite complicated because of the number of layers, but because we’ve built it up slowly it should (hopefully!) make sense. If you see examples of <pkg>ggplot2</pkg> code online that you’d like to adapt, build the plot up layer by layer and it will make it easier to understand what each layer adds.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb22-3"><a href="#cb22-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb22-5"><a href="#cb22-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb22-6"><a href="#cb22-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>),    </span>
<span id="cb22-9"><a href="#cb22-9"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="co"># change the theme</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-theme" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The plot above with a style that makes the border around the plot lighter" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-theme-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The plot above with a style that makes the border around the plot lighter">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Changing the theme to another style.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="theme-tweaks" class="level3" data-number="3.2.5"><h3 data-number="3.2.5" class="anchored" data-anchor-id="theme-tweaks">
<span class="header-section-number">3.2.5</span> Theme tweaks</h3>
<p>If you’re still not quite happy with a theme, you can customise it even further with the <code>themes()</code> function. Check the help for this function to see all of the possible options. The most common thing you’ll want to do is to remove an element entirely. You do this by setting the relevant argument to <code>element_blank()</code>. Below, we’re getting rid of the plot background, which removes the line around the plot.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb23-3"><a href="#cb23-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb23-5"><a href="#cb23-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb23-6"><a href="#cb23-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>),    </span>
<span id="cb23-9"><a href="#cb23-9"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="co"># customise theme elements</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-build-plot-custom-theme" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The plot above with no plot border" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-build-plot-custom-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-build-plot-custom-theme-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The plot above with no plot border">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-build-plot-custom-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Customising the theme to remove the x-axis line and background outline.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-captions" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-captions">
<span class="header-section-number">3.3</span> Figure captions</h2>
<p>You can add a caption directly to the image using the <code>labs()</code> function, which also allows you to add or edit the title, subtitle, and axis labels.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb24-3"><a href="#cb24-3"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, </span>
<span id="cb24-5"><a href="#cb24-5"></a>              <span class="at">formula =</span> y<span class="sc">~</span>x, </span>
<span id="cb24-6"><a href="#cb24-6"></a>              <span class="at">colour =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>),    </span>
<span id="cb24-9"><a href="#cb24-9"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="co"># add labels</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The relationship between Gini index and mean welfare per captita"</span>,</span>
<span id="cb24-15"><a href="#cb24-15"></a>       <span class="at">subtitle =</span> <span class="st">"Data from 2010"</span>,</span>
<span id="cb24-16"><a href="#cb24-16"></a>       <span class="at">caption =</span> <span class="st">"Figure 1. Inequality and welfare have a negative relationship."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-caption" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The plot above with the title and subtitle written above the plot: 'The relationship between Gini index and mean welfare per captita' and 'Data from 2010', and the caption written below: 'Figure 1. Inequality and welfare have a negative relationship.'" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-caption-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-caption-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The plot above with the title and subtitle written above the plot: 'The relationship between Gini index and mean welfare per captita' and 'Data from 2010', and the caption written below: 'Figure 1. Inequality and welfare have a negative relationship.'">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-caption-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: Adding a title, subtitle, and caption.
</figcaption></figure>
</div>
</div>
</div>
<p>However, when you use <code>labs()</code> you are creating a caption that appears inside the rendered plot, specifically in the bottom-right corner by default and can’t be read by a screen reader. It is more accessible to include this sort of information in plain text for screen readers. Instead of using <code>labs()</code> for captions, you can add a text caption in the code chunk header. You should also add alt-text descriptions for screen readers that describe the image.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#| label: fig-gini-welfare</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">#| fig-cap: "Inequality and welfare have a negative relationship."</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#| fig-alt: "A scatterplot showing Gini index on the x-axis (range ~0.2 to 0.65) and mean welfare per capita on the y-axis (range 0 to 100) with a trend line showing that as gini increases from about 0.2 to 0.65, welfare decreases from about 30 to 5."</span></span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co"># figure code here</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="in">```</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add a title, subtitle, caption, and alt-text to your plot.</p>
</div>
</div>
<section id="sec-ggsave" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-ggsave">
<span class="header-section-number">3.3.1</span> Saving Plots</h3>
<p>You can save a ggplot using <code>ggsave()</code>. It saves the last ggplot you made, by default, but you can specify which plot you want to save if you assigned that plot to a variable.</p>
<p>You can set the <code>width</code> and <code>height</code> of your plot. The default units are inches, but you can change the <code>units</code> argument to “in”, “cm”, or “mm”.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>box <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">y =</span> gini)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a>violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">y =</span> gini)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="fu">ggsave</span>(<span class="st">"violin_plot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="fu">ggsave</span>(<span class="st">"box_plot.jpg"</span>, <span class="at">plot =</span> box, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Save two copies of a plot you have made from this chapter with different sizes.</li>
<li>Make sure you can find them on your computer - they should be stored in your project folder.</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The file type is set from the filename suffix, or by specifying the argument <code>device</code>, which can take the following values: “eps”, “ps”, “tex”, “pdf”, “jpeg”, “tiff”, “png”, “bmp”, “svg” or “wmf”.</p>
</div>
</div>
</section></section><section id="sec-appropriate-plots" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-appropriate-plots">
<span class="header-section-number">3.4</span> Appropriate plots</h2>
<p>Now that you know how to build up a plot by layers and customise its appearance, you’re ready to learn about some more plot types. Different types of data require different types of plots, so this section is organised by data type.</p>
<p>The <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot2 cheat sheet</a> is a great resource to help you find plots appropriate to your data, based on how many variables you’re plotting and what type they are. The examples below all use the same poverty and inequality platform data, but each plot communicates something different.</p>
<p>We don’t expect you to memorise all of the plot types or the methods for customising them, but it will be helpful to try out the code in the examples below for yourself, changing values to test your understanding.</p>
<section id="counting-categories" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="counting-categories">
<span class="header-section-number">3.4.1</span> Counting categories</h3>
<section id="bar-plot" class="level4" data-number="3.4.1.1"><h4 data-number="3.4.1.1" class="anchored" data-anchor-id="bar-plot">
<span class="header-section-number">3.4.1.1</span> Bar plot</h4>
<p>If you want to count the number of things per category, you can use <code>geom_bar()</code>. You only need to provide a <code>x</code> mapping to <code>geom_bar()</code> because by default <code>geom_bar()</code> uses the number of observations in each group of <code>x</code> as the value for <code>y</code>, so you don’t need to tell it what to put on the y-axis.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-bar" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A bar plot with region_code on the x-axis with 7 categories and count on the y-axis, ranging from 0 to 30. The x-axis labels are: SAS, MNA, EAP, SSA, LAC, ECA, OHI. Bars increase from about 3 to 27." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A bar plot with region_code on the x-axis with 7 categories and count on the y-axis, ranging from 0 to 30. The x-axis labels are: SAS, MNA, EAP, SSA, LAC, ECA, OHI. Bars increase from about 3 to 27.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.11: A basic bar plot.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>You probably want to customise some things, like the colours, order of the columns, and their labels. Inspect the code below and try running it layer by layer to figure out where these things change. The functions <code>scale_fill_manual()</code> and <code>scale_x_discrete()</code> are new, but work in the same way as the other <code>scale_</code> functions. You can learn more about this in <a href="app-plots.html" class="quarto-xref"><span>Appendix H</span></a>.</p>
<div class="cell" data-layout-align="center" data-webex.hide="Code">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code, </span>
<span id="cb28-2"><a href="#cb28-2"></a>                <span class="at">fill =</span> region_code)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="co"># change order</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"ECA"</span>, <span class="st">"SAS"</span>, <span class="st">"EAP"</span>, <span class="st">"MNA"</span>, <span class="st">"SSA"</span>, <span class="st">"LAC"</span>, <span class="st">"OHI"</span>),</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="co"># change labels (\n creates a line break)</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Europe &amp;</span><span class="sc">\n</span><span class="st">C. Asia"</span>, </span>
<span id="cb28-9"><a href="#cb28-9"></a>               <span class="st">"S. Asia"</span>, </span>
<span id="cb28-10"><a href="#cb28-10"></a>               <span class="st">"E.Asia &amp;</span><span class="sc">\n</span><span class="st">Pacific"</span>,</span>
<span id="cb28-11"><a href="#cb28-11"></a>               <span class="st">"M.East &amp;</span><span class="sc">\n</span><span class="st">N.Africa"</span>, </span>
<span id="cb28-12"><a href="#cb28-12"></a>               <span class="st">"Subsaharan</span><span class="sc">\n</span><span class="st">Africa"</span>, </span>
<span id="cb28-13"><a href="#cb28-13"></a>               <span class="st">"L.America &amp;</span><span class="sc">\n</span><span class="st">Carribean"</span>, </span>
<span id="cb28-14"><a href="#cb28-14"></a>               <span class="st">"Other H.I."</span>) </span>
<span id="cb28-15"><a href="#cb28-15"></a>  ) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb28-17"><a href="#cb28-17"></a>    <span class="co"># change colours</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ECA"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>, </span>
<span id="cb28-19"><a href="#cb28-19"></a>               <span class="st">"SAS"</span> <span class="ot">=</span> <span class="st">"darkorange"</span>, </span>
<span id="cb28-20"><a href="#cb28-20"></a>               <span class="st">"EAP"</span> <span class="ot">=</span> <span class="st">"goldenrod"</span>, </span>
<span id="cb28-21"><a href="#cb28-21"></a>               <span class="st">"MNA"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb28-22"><a href="#cb28-22"></a>               <span class="st">"SSA"</span> <span class="ot">=</span> <span class="st">"dodgerblue3"</span>, </span>
<span id="cb28-23"><a href="#cb28-23"></a>               <span class="st">"LAC"</span> <span class="ot">=</span> <span class="st">"darkorchid"</span>, </span>
<span id="cb28-24"><a href="#cb28-24"></a>               <span class="st">"OHI"</span> <span class="ot">=</span> <span class="st">"hotpink"</span>),</span>
<span id="cb28-25"><a href="#cb28-25"></a>    <span class="co"># remove the legend</span></span>
<span id="cb28-26"><a href="#cb28-26"></a>    <span class="at">guide =</span> <span class="st">"none"</span> </span>
<span id="cb28-27"><a href="#cb28-27"></a>  ) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb28-29"><a href="#cb28-29"></a>    <span class="at">name =</span> <span class="st">""</span>, <span class="co"># remove axis title</span></span>
<span id="cb28-30"><a href="#cb28-30"></a>    <span class="co"># remove the space above and below the y-axis</span></span>
<span id="cb28-31"><a href="#cb28-31"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">0</span>)</span>
<span id="cb28-32"><a href="#cb28-32"></a>  ) <span class="sc">+</span></span>
<span id="cb28-33"><a href="#cb28-33"></a>  <span class="co"># minimum = 0, maximum = 30</span></span>
<span id="cb28-34"><a href="#cb28-34"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)) <span class="sc">+</span> </span>
<span id="cb28-35"><a href="#cb28-35"></a>  <span class="fu">ggtitle</span>(<span class="st">"Number of countries per region"</span>) <span class="co"># add a title</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/custom-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The same plot above, but with the x-axis categoriesin a different order with longer labels, and the bars each a different rainbow colour. The x-axis labels are: Europe &amp; C. Asia, S. Asia, E.Asia &amp; Pacific, M.East &amp; N.Africa, Subsaharan Africa, L.America &amp; Carribean, and Other H.I."></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="column-plot" class="level4" data-number="3.4.1.2"><h4 data-number="3.4.1.2" class="anchored" data-anchor-id="column-plot">
<span class="header-section-number">3.4.1.2</span> Column plot</h4>
<p>If your data already have a column with the number you want to plot, you can use <code>geom_col()</code> to plot it. We can use the <code>count()</code> function to make a table with a row for each <code>region_code</code> and a column called <code>n</code> with the number of observations in that category.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>count_data <span class="ot">&lt;-</span> <span class="fu">count</span>(<span class="at">x =</span> pip, </span>
<span id="cb29-2"><a href="#cb29-2"></a>                    region_code,</span>
<span id="cb29-3"><a href="#cb29-3"></a>                    <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="kable-table">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">region_code</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OHI</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">ECA</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LAC</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">SSA</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EAP</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">MNA</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SAS</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create the table of counts and then view the object <code>count_data</code>.What is each column named?</p>
</div>
</div>
<p>The mapping for <code>geom_col()</code> requires you to set both the <code>x</code> and <code>y</code> aesthetics. Set <code>y = n</code> because we want to plot the number of countries in each category, and that information is in the column called <code>n</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">ggplot</span>(count_data, <span class="fu">aes</span>(<span class="at">x =</span> region_code, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">geom_col</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-col" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A column plot identical to the bar plot above, except the y-axis label is n and not count. It has Region on the x-axis with 7 categories and n on the y-axis, ranging from 0 to 30. The x-axis labels are: SAS, MNA, EAP, SSA, LAC, ECA, OHI. Bars increase from about 3 to 27." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-col-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A column plot identical to the bar plot above, except the y-axis label is n and not count. It has Region on the x-axis with 7 categories and n on the y-axis, ranging from 0 to 30. The x-axis labels are: SAS, MNA, EAP, SSA, LAC, ECA, OHI. Bars increase from about 3 to 27.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-col-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.12: A basic column plot.
</figcaption></figure>
</div>
</div>
</div>
<p>If you wish to organise the bars according to the values, there are several options. You could reorder the underlying data but you can also just make the change for this specific plot using <code>fct_reorder()</code>. Because we have techincally created a new variable, the labelling doesn’t carry over so we can use <code>labs()</code> to edit it.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>(count_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(region_code, <span class="co"># variable to reorder</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>                                       n), <span class="co"># what to order it by</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>                       <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Region"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="pie-chart" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="pie-chart">
<span class="header-section-number">3.4.2</span> Pie chart</h3>
<p>Pie charts are a <a href="https://www.data-to-viz.com/caveat/pie.html">misleading form of data visualisation</a>, so we won’t cover them. We cover options for visualising proportions, like waffle, lollipop and treemap plots, in <a href="app-plots.html" class="quarto-xref"><span>Appendix H</span></a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Test your understanding; here is a small data table.</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">population</th>
<th style="text-align: left;">island</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Northern Ireland</td>
<td style="text-align: right;">1,895,510</td>
<td style="text-align: left;">Ireland</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wales</td>
<td style="text-align: right;">3,169,586</td>
<td style="text-align: left;">Great Britain</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Republic of Ireland</td>
<td style="text-align: right;">4,937,786</td>
<td style="text-align: left;">Ireland</td>
</tr>
<tr class="even">
<td style="text-align: left;">Scotland</td>
<td style="text-align: right;">5,466,000</td>
<td style="text-align: left;">Great Britain</td>
</tr>
<tr class="odd">
<td style="text-align: left;">England</td>
<td style="text-align: right;">56,550,138</td>
<td style="text-align: left;">Great Britain</td>
</tr>
</tbody>
</table>
<ul>
<li>What geom would you use to plot the population for each of the 5 countries? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_bar</option>
<option value="answer">geom_col</option></select>
</li>
</ul>
<div class="cell" data-layout-align="center">
<ul>
<li>What mapping would you use?
<div id="radio_GZNWBGSREF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GZNWBGSREF" value="answer"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_GZNWBGSREF" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_GZNWBGSREF" value="x"><span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_GZNWBGSREF" value="x"><span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_GZNWBGSREF" value="x"><span>aes(y = population)</span></label>
</div>
</li>
</ul>
</div>
<ul>
<li>What geom would you use to plot the number of countries on each island? <select class="webex-select"><option value="blank"></option>
<option value="answer">geom_bar</option>
<option value="x">geom_col</option></select>
</li>
</ul>
<div class="cell" data-layout-align="center">
<ul>
<li>What mapping would you use?
<div id="radio_TAWFLGAXIG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TAWFLGAXIG" value="x"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_TAWFLGAXIG" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_TAWFLGAXIG" value="x"><span>aes(x = country)</span></label><label><input type="radio" autocomplete="off" name="radio_TAWFLGAXIG" value="answer"><span>aes(x = island)</span></label><label><input type="radio" autocomplete="off" name="radio_TAWFLGAXIG" value="x"><span>aes(y = population)</span></label>
</div>
</li>
</ul>
</div>
</div>
</div>
</section><section id="sec-histogram" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="sec-histogram">
<span class="header-section-number">3.4.3</span> One continuous variable</h3>
<p>If you have a continuous variable, like <code>welfare_mean</code>, you can use <code>geom_histogram()</code> to show the distribution. Just like <code>geom_bar()</code> you are only required to specify the <code>x</code> variable.</p>
<p>A histogram splits the data into “bins” along the x-axis and shows the count of how many observations are in each bin along the y-axis.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-histogram" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot with Mean Welfare per Capita on the x-axis, ranging from 0 to 90, and count on the y-axis, ranging from 0 to 11. The histogram shows most values between 0 and 25, with fewer spread out between 30 and 90." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-histogram-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A plot with Mean Welfare per Capita on the x-axis, ranging from 0 to 90, and count on the y-axis, ranging from 0 to 11. The histogram shows most values between 0 and 25, with fewer spread out between 30 and 90.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.13: Histogram of mean welfare per capita.
</figcaption></figure>
</div>
</div>
</div>
<p>You should always set the <code>binwidth</code> or number of <code>bins</code> to something meaningful for your data (otherwise you get the annoying message above). You might need to try a few options before you find something that looks good and conveys the meaning of your plot – try changing the values of <code>binwidth</code> and <code>bins</code> in the code below to see what works best.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># adjust width of each bar</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co"># adjust number of bars</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>By default, the bars start <em>centered</em> on 0, so if <code>binwidth</code> is set to 5, the first bar would include -2.5 to +2.5, which doesn’t make much sense. We can set <code>boundary = 0</code> so that each bar represents increments of 5 <em>starting</em> from 0.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">boundary =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-histogram-boundary0" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The same plot as above, but the first bar spans 0-5 instead of 2.5 to 7.5." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-boundary0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-histogram-boundary0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The same plot as above, but the first bar spans 0-5 instead of 2.5 to 7.5.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-boundary0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.14: A histogram with the boundary set to 0.
</figcaption></figure>
</div>
</div>
</div>
<p>Finally, the default style of grey bars is ugly, so you can change that by setting the <code>fill</code> and <code>colour</code>, as well as using <code>scale_x_continuous()</code> to update the axis labels.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb36-3"><a href="#cb36-3"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb36-4"><a href="#cb36-4"></a>                 <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb36-5"><a href="#cb36-5"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Mean Welfare per Capita"</span>,</span>
<span id="cb36-7"><a href="#cb36-7"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-histogram-custom" class="quarto-float quarto-figure quarto-figure-center anchored" alt="The same plot as above, but the bars are white with black borders, instead of grey with grey borders." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-custom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-histogram-custom-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="The same plot as above, but the bars are white with black borders, instead of grey with grey borders.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-custom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.15: Histogram with custom styles.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Test your understanding</p>
<p>Imagine you have a table of the <a href="https://population.un.org/wpp/Download/Standard/Population/">population for each country in the world</a> with the columns <code>country</code> and <code>population</code>. We’ll just look at the 76 countries with populations of less than a million.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/test-one-continuous-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A histogram with population (from 0K to 1M in 100K steps) on the x-axis and Number of countries (0-35) on the y-axis. Most countries (36) have 0-100K, with 12 having 100-1200K, and 6 or fewer having each step above."></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<ul>
<li>How would you set the mapping for this plot?
<div id="radio_GCGXEEBYCM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GCGXEEBYCM" value="x"><span>aes(x = country, y = population)</span></label><label><input type="radio" autocomplete="off" name="radio_GCGXEEBYCM" value="x"><span>aes(x = population, y = country)</span></label><label><input type="radio" autocomplete="off" name="radio_GCGXEEBYCM" value="answer"><span>aes(x = population)</span></label><label><input type="radio" autocomplete="off" name="radio_GCGXEEBYCM" value="x"><span>aes(x = population, y = count)</span></label>
</div>
</li>
</ul>
</div>
<ul>
<li>What is the <code>binwidth</code> of the histogram? <select class="webex-select"><option value="blank"></option>
<option value="">1</option>
<option value="">100</option>
<option value="answer">100K</option>
<option value="">1M</option></select>
</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Axis label customisation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you’re curious how we got the x-axis labels to read “100K” instead of “100000”, you just need to add a vector of <code>labels</code> the same length as <code>breaks</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1e6</span>, <span class="fl">1e5</span>),</span>
<span id="cb37-2"><a href="#cb37-2"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span><span class="sc">*</span><span class="dv">100</span>, <span class="st">"K"</span>), <span class="st">"1M"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section><section id="grouped-continuous-variables" class="level3" data-number="3.4.4"><h3 data-number="3.4.4" class="anchored" data-anchor-id="grouped-continuous-variables">
<span class="header-section-number">3.4.4</span> Grouped continuous variables</h3>
<p>There are several ways to compare continuous data across groups. Which you choose depends on what point you are trying to make with the plot.</p>
<section id="stacked-histogram" class="level4" data-number="3.4.4.1"><h4 data-number="3.4.4.1" class="anchored" data-anchor-id="stacked-histogram">
<span class="header-section-number">3.4.4.1</span> Stacked histogram</h4>
<p>In previous plots, we have used <code>fill</code> purely for visual reasons, e.g., we changed the colour of the histogram bars to make them look nicer. However, you can also use <code>fill</code> to represent another variable so that the colours become meaningful.</p>
<p>Setting the <code>fill</code> aesthetic <strong>in the mapping</strong> will produce different coloured bars for each category of the <code>fill</code> variable, in this case <code>region_code</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean, <span class="at">fill =</span> region_code)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb38-3"><a href="#cb38-3"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-hist-fill" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A stacked histogram with welfare_mean on the x-axis ranging from 0-90 and count on the y-axis ranging from 0-15. Each region_code is represented by a different colour. OHI is pink and has most of the welfare scores above 30, while the other countries are rainbow coloours red to purple and mostly have welfare scores 0-30." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hist-fill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-hist-fill-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A stacked histogram with welfare_mean on the x-axis ranging from 0-90 and count on the y-axis ranging from 0-15. Each region_code is represented by a different colour. OHI is pink and has most of the welfare scores above 30, while the other countries are rainbow coloours red to purple and mostly have welfare scores 0-30.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-fill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.16: Histogram with categories represented by fill.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Arguments inside aes()
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you set an aspect to represent the data, you do this inside the <code>aes()</code> function for the mapping, not as an argument to the geom. If you try to set this in a geom, you’ll get the following error (unless you coincidentally have an object named <code>region_code</code> that is a colour word).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb39-3"><a href="#cb39-3"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb39-4"><a href="#cb39-4"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb39-5"><a href="#cb39-5"></a>                 <span class="at">fill =</span> region_code)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'region_code' not found</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Area plot alternative
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The function <code>geom_area()</code> gives a similar effect when <code>stat = "bin"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># area plot</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">ggplot</span>(pip, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean, <span class="at">fill =</span> region_code)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">geom_area</span>(<span class="at">stat =</span> <span class="st">"bin"</span>, </span>
<span id="cb41-4"><a href="#cb41-4"></a>            <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb41-5"><a href="#cb41-5"></a>            <span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb41-6"><a href="#cb41-6"></a>            <span class="at">color =</span> <span class="st">"black"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-stacked-area" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A stacked area plot like the previous stacked histogram, but the value for each bin is connected by lines and the area underneath coloured in." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stacked-area-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-stacked-area-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A stacked area plot like the previous stacked histogram, but the value for each bin is connected by lines and the area underneath coloured in.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stacked-area-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.17: Stacked area plot.
</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="dodged-histogram" class="level4" data-number="3.4.4.2"><h4 data-number="3.4.4.2" class="anchored" data-anchor-id="dodged-histogram">
<span class="header-section-number">3.4.4.2</span> Dodged histogram</h4>
<p>By default, the categories are positioned stacked on top of each other. If you want to compare more than one distribution, you can set the <code>position</code> argument of <code>geom_histogram()</code> to “dodge” to put the bars for each group next to each other instead of stacking them. However, this can look confusing with several categories.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># dodged histogram</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean, </span>
<span id="cb42-3"><a href="#cb42-3"></a>               <span class="at">fill =</span> region_code,</span>
<span id="cb42-4"><a href="#cb42-4"></a>               <span class="at">colour =</span> region_code))<span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">geom_histogram</span>(<span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb42-6"><a href="#cb42-6"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb42-7"><a href="#cb42-7"></a>                 <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Mean Welfare per Capita"</span>,</span>
<span id="cb42-9"><a href="#cb42-9"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-histogram-dodge" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A histogram with welfare_mean on the x-axis ranging from 0-90 and count on the y-axis ranging from 0-7. Instead of stacking bars, each bar is very thin and placed next to the others (it is hard to read). Each region_code is represented by a different colour. OHI is pink and has most of the welfare scores above 30, while the other countries are rainbow coloours red to purple and mostly have welfare scores 0-30." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogram-dodge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-histogram-dodge-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A histogram with welfare_mean on the x-axis ranging from 0-90 and count on the y-axis ranging from 0-7. Instead of stacking bars, each bar is very thin and placed next to the others (it is hard to read). Each region_code is represented by a different colour. OHI is pink and has most of the welfare scores above 30, while the other countries are rainbow coloours red to purple and mostly have welfare scores 0-30.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogram-dodge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.18: A histogram with multiple groups.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Frequency plot alternative
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Alternatively, you can use <code>geom_freqpoly()</code> to plot a line connecting the top of each bin.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># frequency plot</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean,</span>
<span id="cb43-3"><a href="#cb43-3"></a>                <span class="at">colour =</span> region_code)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb43-5"><a href="#cb43-5"></a>                <span class="at">boundary =</span> <span class="dv">0</span>,</span>
<span id="cb43-6"><a href="#cb43-6"></a>                <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Mean Welfare per Capita"</span>,</span>
<span id="cb43-8"><a href="#cb43-8"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-groups-freqpoly" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot like above, but showing lines connecting the levels instead of bars." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-groups-freqpoly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-groups-freqpoly-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A plot like above, but showing lines connecting the levels instead of bars.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-groups-freqpoly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.19: A frequency plot with multiple groups.
</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="violin-plot" class="level4" data-number="3.4.4.3"><h4 data-number="3.4.4.3" class="anchored" data-anchor-id="violin-plot">
<span class="header-section-number">3.4.4.3</span> Violin plot</h4>
<p>Another way to compare groups of continuous variables is the violin plot. This is like a density plot, but rotated 90 degrees and mirrored - the fatter the violin, the larger proportion of data points there are at that value.</p>
<p><code>geom_violin()</code> provides three scaling options. With scale = “area” (the default), each violin has the same total area, so widths reflect density only. With scale = “count”, the maximum width is proportional to the number of observations, so larger groups appear wider. With scale = “width”, each violin has the same maximum width, emphasising differences in distribution shape rather than sample size.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>violin_area <span class="ot">&lt;-</span> </span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">"area"</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">ggtitle</span>(<span class="st">'scale = "area" (default)'</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a>violin_count <span class="ot">&lt;-</span> </span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">ggtitle</span>(<span class="st">'scale = "count"'</span>)</span>
<span id="cb44-10"><a href="#cb44-10"></a></span>
<span id="cb44-11"><a href="#cb44-11"></a>violin_width <span class="ot">&lt;-</span> </span>
<span id="cb44-12"><a href="#cb44-12"></a>  <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">"width"</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="fu">ggtitle</span>(<span class="st">'scale = "width"'</span>)</span>
<span id="cb44-15"><a href="#cb44-15"></a></span>
<span id="cb44-16"><a href="#cb44-16"></a>violin_area <span class="sc">/</span> violin_count <span class="sc">/</span> violin_width</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-violin-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Three versions of violin plots. The top panel shows scale = 'area' (default). The middle panel shows scale = 'count'. The bottom panel shows scale = 'width'." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-violin-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-violin-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Three versions of violin plots. The top panel shows scale = 'area' (default). The middle panel shows scale = 'count'. The bottom panel shows scale = 'width'.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.20: The default violin plot gives each shape the same area. Set scale=‘count’ to make the size proportional to the number of observations, or scale=‘width’ to give all violins the same maximum width.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="boxplot" class="level4" data-number="3.4.4.4"><h4 data-number="3.4.4.4" class="anchored" data-anchor-id="boxplot">
<span class="header-section-number">3.4.4.4</span> Boxplot</h4>
<p>Boxplots serve a similar purpose to violin plots (without the giggles from the back row). They don’t show you the shape of the distribution, but rather some statistics about it. The middle line represents the <a href="https://psyteachr.github.io/glossary/m#median" target="_blank" class="glossary" title="The middle number in a distribution where half of the values are larger and half are smaller.">median</a>; half the data are above this line and half below it. The box encloses the 25th to 75th percentiles of the data, so 50% of the data falls inside the box. The “whiskers” extending above and below the box extend 1.5 times the height of the box, although you can change this with the <code>coef</code> argument. The points show <a href="https://psyteachr.github.io/glossary/o#outlier" target="_blank" class="glossary" title="A data point that is extremely distant from most of the other data points">outliers</a> – individual data points that fall outside of this range.</p>
<p>Boxplots can be horizontal if you swap to x and y columns, and there are many other customisations you can apply.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> region_code, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2"></a> <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">ggtitle</span>(<span class="st">"Default vertical boxplot"</span>)</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a>custom <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pip, <span class="fu">aes</span>(<span class="at">x =</span> welfare_mean, <span class="at">y =</span> region_code)) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a> <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, </span>
<span id="cb45-7"><a href="#cb45-7"></a>              <span class="at">outlier.colour =</span> <span class="st">"red"</span>,</span>
<span id="cb45-8"><a href="#cb45-8"></a>              <span class="at">outlier.shape =</span> <span class="dv">8</span>,</span>
<span id="cb45-9"><a href="#cb45-9"></a>              <span class="at">coef =</span> <span class="dv">1</span>,   <span class="co"># length of whiskers relative to box</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>              <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="co"># set width proportional to sample size</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>              <span class="at">staplewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>  <span class="fu">ggtitle</span>(<span class="st">"Customised horizontal boxplot"</span>)</span>
<span id="cb45-13"><a href="#cb45-13"></a></span>
<span id="cb45-14"><a href="#cb45-14"></a>boxplot <span class="sc">+</span> custom</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-box-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Two boxplots. The left plot is labelled 'Default vertical boxpplot' and shows the 7 region_codes along the x-axis and melfare_mean (0-90) on the y-axis. Boxplots are white with black outlines and show the median, whiskers, and outlier points. The right plot is labelled `Customised horizontal boxplot and has grey fill in the boxes, capped whiskers, and red asterisks for outliers." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-box-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-box-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Two boxplots. The left plot is labelled 'Default vertical boxpplot' and shows the 7 region_codes along the x-axis and melfare_mean (0-90) on the y-axis. Boxplots are white with black outlines and show the median, whiskers, and outlier points. The right plot is labelled `Customised horizontal boxplot and has grey fill in the boxes, capped whiskers, and red asterisks for outliers.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-box-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.21: Boxplots.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="combo-plots" class="level4" data-number="3.4.4.5"><h4 data-number="3.4.4.5" class="anchored" data-anchor-id="combo-plots">
<span class="header-section-number">3.4.4.5</span> Combo plots</h4>
<p>Violin plots are frequently layered with other geoms that represent the mean or median values in the data. This is a lot of code; to help your understanding, run it layer by layer to see how it builds up and change the values throughout the code.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># add fill and colour to the mapping</span></span>
<span id="cb46-2"><a href="#cb46-2"></a></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> region_code, </span>
<span id="cb46-4"><a href="#cb46-4"></a>                 <span class="at">y =</span> welfare_mean,</span>
<span id="cb46-5"><a href="#cb46-5"></a>                 <span class="at">fill =</span> region_code,</span>
<span id="cb46-6"><a href="#cb46-6"></a>                 <span class="at">colour =</span> region_code)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Region"</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mean Welfare per Capita"</span>,</span>
<span id="cb46-9"><a href="#cb46-9"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">colour =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb46-12"><a href="#cb46-12"></a>  <span class="co"># add a violin plot</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb46-14"><a href="#cb46-14"></a>              <span class="at">scale =</span> <span class="st">"width"</span>) <span class="sc">+</span> </span>
<span id="cb46-15"><a href="#cb46-15"></a>  <span class="co"># add a boxplot</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.25</span>, </span>
<span id="cb46-17"><a href="#cb46-17"></a>               <span class="at">fill =</span> <span class="st">"white"</span>, </span>
<span id="cb46-18"><a href="#cb46-18"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>, </span>
<span id="cb46-19"><a href="#cb46-19"></a>               <span class="at">median.linewidth =</span> <span class="dv">0</span>, <span class="co"># removes the median line</span></span>
<span id="cb46-20"><a href="#cb46-20"></a>               <span class="at">outlier.alpha =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb46-21"><a href="#cb46-21"></a>  <span class="co"># add a point that represents the mean</span></span>
<span id="cb46-22"><a href="#cb46-22"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, </span>
<span id="cb46-23"><a href="#cb46-23"></a>               <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb46-24"><a href="#cb46-24"></a>               <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb46-25"><a href="#cb46-25"></a>               <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span> </span>
<span id="cb46-26"><a href="#cb46-26"></a>  <span class="fu">ggtitle</span>(<span class="st">"ViolinBox"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-violin-combos" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot labelled 'ViolinBox' with 'Mean welfare per Capita' on the y-axis (0-90) and 'Region' (7 categories) on the x-axis. Each region is represented by a rainbow coloured violin with a boxplot inside it." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-violin-combos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-violin-combos-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A plot labelled 'ViolinBox' with 'Mean welfare per Capita' on the y-axis (0-90) and 'Region' (7 categories) on the x-axis. Each region is represented by a rainbow coloured violin with a boxplot inside it.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-combos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.22: Violin plots combined with different methods to represent means and medians.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Test your understanding</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03-viz_files/figure-html/test-grouped-continuous-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Two plots. Both have gini (.3 to .6) on the y-axis and the 7 region_codes on the x-axis, with each region plotted in a different colour. Plot A shows curved shapes that represent the density of data at that point on the y-axis. Plot B has rectangular shapes that enclose the 25th to 75th percentile of data, adding lines at the median and whiskers representing the range."></p>
</figure>
</div>
</div>
</div>
<ul>
<li>How would you create plot A? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_box()</option>
<option value="x">geom_boxplot()</option>
<option value="answer">geom_violin()</option>
<option value="x">geom_violinplot()</option></select>
</li>
<li>How would you create plot B? <select class="webex-select"><option value="blank"></option>
<option value="x">geom_box()</option>
<option value="answer">geom_boxplot()</option>
<option value="x">geom_violin()</option>
<option value="x">geom_violinplot()</option></select>
</li>
<li>What does the mapping look like for both plots?
<div id="radio_SVENQIVPWQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SVENQIVPWQ" value="answer"><span>aes(x = region_code, y = gini, fill = region_code)</span></label><label><input type="radio" autocomplete="off" name="radio_SVENQIVPWQ" value="x"><span>aes(x = region_code, y = gini, colour = region_code)</span></label><label><input type="radio" autocomplete="off" name="radio_SVENQIVPWQ" value="x"><span>aes(x = region_code, y = gini, colour = gini)</span></label><label><input type="radio" autocomplete="off" name="radio_SVENQIVPWQ" value="x"><span>aes(x = region_code, y = gini, fill = gini)</span></label>
</div>
</li>
</ul>
</div>
</div>
</section></section><section id="two-continuous-variables" class="level3" data-number="3.4.5"><h3 data-number="3.4.5" class="anchored" data-anchor-id="two-continuous-variables">
<span class="header-section-number">3.4.5</span> Two continuous variables</h3>
<p>When you want to see how two continuous variables are related, set one as the x-axis and the other as the y-axis. Usually, if one variable causes the other, you plot the cause on the x-axis and the effect on the y-axis. Here, we want to see if longer wait times cause the calls to be longer.</p>
<section id="scatterplot" class="level4" data-number="3.4.5.1"><h4 data-number="3.4.5.1" class="anchored" data-anchor-id="scatterplot">
<span class="header-section-number">3.4.5.1</span> Scatterplot</h4>
<p>The function to create a scatterplot is called <code>geom_point()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-demo-point" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A scatterplot with gini (0.2-0.7) on the x-axis and welfare_mean (0-90) on the y-axis. The dots are solid black." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-demo-point-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-demo-point-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A scatterplot with gini (0.2-0.7) on the x-axis and welfare_mean (0-90) on the y-axis. The dots are solid black.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-demo-point-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.23: Scatterplot with geom_point().”
</figcaption></figure>
</div>
</div>
</div>
</section><section id="trendlines" class="level4" data-number="3.4.5.2"><h4 data-number="3.4.5.2" class="anchored" data-anchor-id="trendlines">
<span class="header-section-number">3.4.5.2</span> Trendlines</h4>
<p>In <a href="#fig-layers" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>, we emphasised the relationship between Gini index and welfare with a trendline created by <code>geom_smooth()</code>.</p>
<p>When you add a trendline with <code>geom_smooth()</code>, R is creating a best-guess line that tries to follow the pattern in your data. The shaded ribbon around the line shows how confident the model is: a narrow ribbon means the pattern is fairly certain, while a wide ribbon means the data are too sparse or variable to be sure. Different methods create lines with different levels of flexibility.</p>
<p>A linear model draws the simplest possible line, which is straight from one side of the plot to the other. A loess line adapts more to the data, so it can curve or wiggle if the pattern changes. A quadratic model sits between these two: it is still smooth, but it allows for a single bend. None of these lines are “the truth”. They are tools to help you see overall trends, and the choice between them depends on how simple or flexible you want your summary of the data to be.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>loess_plot <span class="ot">&lt;-</span> </span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> loess, <span class="at">formula =</span> y<span class="sc">~</span>x) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="fu">ggtitle</span>(<span class="st">"Default: method = loess, formula = y~x"</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a>lm_plot <span class="ot">&lt;-</span> </span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y<span class="sc">~</span>x) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>  <span class="fu">ggtitle</span>(<span class="st">"Linear: method = lm, formula = y~x"</span>)</span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a>lm2_plot <span class="ot">&lt;-</span> </span>
<span id="cb48-14"><a href="#cb48-14"></a>  <span class="fu">ggplot</span>(pip,  <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> welfare_mean)) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y<span class="sc">~</span>x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quadratic: method = lm, formula = y~x + I(x^2)"</span>)</span>
<span id="cb48-18"><a href="#cb48-18"></a></span>
<span id="cb48-19"><a href="#cb48-19"></a>loess_plot <span class="sc">/</span> lm_plot <span class="sc">/</span> lm2_plot </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-2-continuous" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Thre versions of a trend line trhough the scatterplot above with gini (0.2-0.7) on the x-axis and welfare_mean (0-90) on the y-axis. The dots are transparent black. The top plot 'Default: method = loess, formula = y~x' shows a wavy line through the points. The middle plot 'Linear: method = lm, formula = y~x' shows a straight line. The bottom plot 'Quadratic: method = lm, formula = y~x + I(x^2)' shows a smoothly curved line." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-2-continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-2-continuous-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Thre versions of a trend line trhough the scatterplot above with gini (0.2-0.7) on the x-axis and welfare_mean (0-90) on the y-axis. The dots are transparent black. The top plot 'Default: method = loess, formula = y~x' shows a wavy line through the points. The middle plot 'Linear: method = lm, formula = y~x' shows a straight line. The bottom plot 'Quadratic: method = lm, formula = y~x + I(x^2)' shows a smoothly curved line.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-continuous-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.24: Different ways to show the relationship between two continuous variables.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Error shading
</div>
</div>
<div class="callout-body-container callout-body">
<p>If there isn’t much data at the extremes of the x-axis, the curve can be very uncertain. This is represented by the wider shaded area, which means that the true relationship might be anywhere within that area. Add the argument <code>se = FALSE</code> to <code>geom_smooth()</code> to remove this “standard error” shading.</p>
</div>
</div>
</section></section><section id="simulated-data" class="level3" data-number="3.4.6"><h3 data-number="3.4.6" class="anchored" data-anchor-id="simulated-data">
<span class="header-section-number">3.4.6</span> Simulated data</h3>
<p>We’ll need some different data for the next few plots.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Run the following code to simulate some data with random dates in the year 2025, random rating on an ordinal scale from 1 to 5, and random scores on a continuous scale from 0-100 that increase over the year and have an inverted-U shaped relationship to rating.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>) <span class="co"># makes the simulation reproducible</span></span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of data points to simulate</span></span>
<span id="cb49-4"><a href="#cb49-4"></a></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co"># make a vector of the first day of the month</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.POSIXct</span>(<span class="st">'2025-01-01'</span>), <span class="fu">as.POSIXct</span>(<span class="st">'2025-12-31'</span>), <span class="at">by =</span> <span class="st">"sec"</span>)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="co"># sample n datetimes and randomly assign groups A:E</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="co"># create n scores from a random normal distribution</span></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="co"># where the mean depends on the month and rating</span></span>
<span id="cb49-11"><a href="#cb49-11"></a>simdat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-12"><a href="#cb49-12"></a>  <span class="at">datetime =</span> <span class="fu">sample</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-13"><a href="#cb49-13"></a>  <span class="at">rating =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-14"><a href="#cb49-14"></a>  <span class="at">mean =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fu">month</span>(datetime) <span class="sc">-</span> <span class="dv">6</span> <span class="sc">+</span> <span class="fu">abs</span>(rating <span class="sc">-</span> <span class="dv">3</span>)<span class="sc">*</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb49-15"><a href="#cb49-15"></a>  <span class="at">score =</span> <span class="fu">rnorm</span>(n, mean, <span class="at">sd =</span> <span class="dv">12</span>)</span>
<span id="cb49-16"><a href="#cb49-16"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Explain what the data simulation is doing
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>This fixes the random-number generator so that every time you run the simulation, you get the same random values. This is essential for reproducibility, especially in teaching materials.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol start="2" type="1">
<li>This sets the number of simulated data points you want to create. You will end up with 10,000 rows in your final tibble.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol start="3" type="1">
<li>This creates a huge sequence of datetimes:</li>
</ol>
<ul>
<li>starting at 1 January 2025</li>
<li>ending at 31 December 2025</li>
<li>with one-second increments</li>
</ul>
<p>There are about 31.5 million seconds in a year, so <code>d</code> contains roughly 31.5 million possible timestamps. You will later sample from this vector to give each simulated observation a random datetime somewhere in 2025.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.POSIXct</span>(<span class="st">'2025-01-01'</span>), <span class="fu">as.POSIXct</span>(<span class="st">'2025-12-31'</span>), <span class="at">by =</span> <span class="st">"sec"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol start="4" type="1">
<li>The simulated dataset is created using <code>tibble()</code>, which lets you define each column directly. The first column, <code>datetime</code>, is generated by taking 10,000 random samples from the long vector of <code>datetimes</code> using <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>, so each observation receives a timestamp somewhere in 2025.</li>
</ol>
<p>The second column, rating, uses another call to <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> to assign each observation a random value from 1 to 5, mimicking a five-point rating scale. The mean column calculates an expected score for each observation by combining the month (extracted with <code>month(datetime)</code>) and the rating, so scores tend to rise later in the year and vary depending on how far the rating is from the midpoint.</p>
<p>The final column, <code>score</code>, uses <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> to add random variation by drawing a value from a normal distribution centred on the calculated mean, with a standard deviation of 12.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="at">datetime =</span> <span class="fu">sample</span>(d, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="at">rating =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="at">mean =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fu">month</span>(datetime) <span class="sc">-</span> <span class="dv">6</span> <span class="sc">+</span> <span class="fu">abs</span>(rating <span class="sc">-</span> <span class="dv">3</span>)<span class="sc">*</span><span class="dv">5</span> <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="at">score =</span> <span class="fu">rnorm</span>(n, mean, <span class="at">sd =</span> <span class="dv">12</span>)</span>
<span id="cb53-6"><a href="#cb53-6"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section><section id="overplotting" class="level3" data-number="3.4.7"><h3 data-number="3.4.7" class="anchored" data-anchor-id="overplotting">
<span class="header-section-number">3.4.7</span> Overplotting</h3>
<p>When you have a limited range of numeric values, such as an ordinal rating scale, sometimes overlapping data makes it difficult to see what is going on in a point plot. For example, the plot below shows score by rating, but because there are only 5 levels and a lot of data, it makes it hard to see exactly how many data points there are at each rating level.</p>
<p>In this section, we’ll explore a few options for dealing with this.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">ggplot</span>(simdat, <span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> rating)) <span class="sc">+</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">geom_point</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-over-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A point plot with score (0-100) on the xi-axis and rating (1-5) on the y-axis. Since there are only 5 scores, all of the points are bunched up on the same 5 lines and span nearly the whole x-axis range. This is difficult to read." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-over-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-over-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="A point plot with score (0-100) on the xi-axis and rating (1-5) on the y-axis. Since there are only 5 scores, all of the points are bunched up on the same 5 lines and span nearly the whole x-axis range. This is difficult to read.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-over-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.25: Overlapping data makes plots hard to understand.
</figcaption></figure>
</div>
</div>
</div>
<section id="jitter-plot" class="level4" data-number="3.4.7.1"><h4 data-number="3.4.7.1" class="anchored" data-anchor-id="jitter-plot">
<span class="header-section-number">3.4.7.1</span> Jitter plot</h4>
<p>You can use <code>geom_jitter()</code> to move the points around a bit to make them easier to see. You can also set alpha transparency. Here, the x-axis is continuous, so there is no need to jitter the <code>width</code>, but the y-axis is ordinal, so the <code>height</code> is jittered between -0.2 and +0.2 days away from the true y-value.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change the values in this code (range between 0 and 1) to understand what jitter is doing</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">ggplot</span>(simdat, <span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> rating)) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</section><section id="facets" class="level4" data-number="3.4.7.2"><h4 data-number="3.4.7.2" class="anchored" data-anchor-id="facets">
<span class="header-section-number">3.4.7.2</span> Facets</h4>
<p>Alternatively, you can use <code>facet_wrap()</code> to create a separate plot for each rating. <code>facet_wrap()</code> uses the tilde (~) symbol, which you can roughly translate as “by”, e.g., facet the plot <em>by</em> rating. The <code>labeller</code> function controls the labels above each plot. <code>label_both</code> specifies that we want both the variable name (rating) and the value (e.g., 1) printed on the plot to make it easier to read.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">ggplot</span>(simdat, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, </span>
<span id="cb56-3"><a href="#cb56-3"></a>                 <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb56-4"><a href="#cb56-4"></a>                 <span class="at">fill =</span> <span class="st">"dodgerblue"</span>, </span>
<span id="cb56-5"><a href="#cb56-5"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rating, </span>
<span id="cb56-7"><a href="#cb56-7"></a>             <span class="at">ncol =</span> <span class="dv">1</span>, <span class="co"># try changing this to 2 </span></span>
<span id="cb56-8"><a href="#cb56-8"></a>             <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Score"</span>,</span>
<span id="cb56-10"><a href="#cb56-10"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-facet-plot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Five plots, one for each rating level, showing a histogram of the score distribution. The x-axis shows score ranging from 0 to 100 and the y-axis shows count ranging from 0 to 300. All plots show a normal distribution centered around 55, 50, 45, 50, and 55 for the ratings 1-5." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-facet-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-viz_files/figure-html/fig-facet-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Five plots, one for each rating level, showing a histogram of the score distribution. The x-axis shows score ranging from 0 to 100 and the y-axis shows count ranging from 0 to 300. All plots show a normal distribution centered around 55, 50, 45, 50, and 55 for the ratings 1-5.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-facet-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.26: A histogram with facets.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>More plots styles
</div>
</div>
<div class="callout-body-container callout-body">
<p>These are not, by any means, all the plot types that you can make in R. This chapter just gave you a basic overview, and we will go into more detail in <a href="app-plots.html" class="quarto-xref"><span>Appendix H</span></a>). The <a href="#resources-viz">further resources</a> section at the end of this chapter lists many resources, but the <a href="http://www.r-graph-gallery.com/">R Graph Gallery</a> is especially useful to get inspiration for the kinds of beautiful plots you can make in R.</p>
</div>
</div>
</section></section></section><section id="sec-advanced-plots" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="sec-advanced-plots">
<span class="header-section-number">3.5</span> Advanced</h2>
<p>If you would like to go beyond what we’ve covered in this chapter, we recommend the following Advanced appendices:</p>
<ul>
<li>Advanced: Styling Plots (<a href="app-styling.html" class="quarto-xref"><span>Appendix F</span></a>)</li>
<li>Advanced: More Plots (<a href="app-plots.html" class="quarto-xref"><span>Appendix H</span></a>)</li>
<li>Advanced: Data Types (<a href="app-datatypes.html" class="quarto-xref"><span>Appendix D</span></a>)</li>
</ul></section><section id="sec-exercises-viz" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="sec-exercises-viz">
<span class="header-section-number">3.6</span> Peer Coding Exercises</h2>
<p>If you’re enrolled on PSYCH1012 Applied Data Skills, do not do these exercises until the Tuesday workshop.</p>
<ul>
<li><p>The Driver operates the keyboard, implements the next small step, narrates what they are doing.</p></li>
<li><p>The Navigator reviews in real time, thinks ahead, checks naming, design, and help pages, and catches mistakes and typos.</p></li>
</ul>
<p>For the final step in this chapter, we will create a report of data visualisations. You may need to refer back to <a href="02-reports.html" class="quarto-xref"><span>Chapter 2</span></a>) to help you complete these exercises. We’d also recommend you <a href="https://psyteachr.github.io/glossary/r#render" target="_blank" class="glossary" title="To create a file (usually an image or PDF) or widget from source code">render</a> at every step so that you can see how your output changes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are no solutions provided for the pair programming activities. Everything you need is in this chapter of the book so use the search function and work together to solve any problems.</p>
<ol type="1">
<li><p>Decide who is going to start as the Driver and Navigator. Remember to switch every so often! The Navigator will find it helpful to have a copy of these instructions open and read the next step to the Driver.</p></li>
<li><p>Create and save a new quarto document named <code>03-dataviz-exercises.qmd</code>. Give it the title “Personality Data” and remove the default template text.</p></li>
<li><p>Add the code below in the set-up code chunk:</p></li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb57-1"><a href="#cb57-1"></a><span class="in">```{r}</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co">#| label: setup</span></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co">#| include: false</span></span>
<span id="cb57-4"><a href="#cb57-4"></a></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="fu">library</span>(patchwork) </span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="fu">library</span>(ggthemes)  </span>
<span id="cb57-8"><a href="#cb57-8"></a></span>
<span id="cb57-9"><a href="#cb57-9"></a>personality <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://psyteachr.github.io/ads-v3/data/personality_scores.csv"</span>)</span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="in">```</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="4" type="1">
<li>Give human-readable labels to the columns you’ll be plotting:</li>
</ol>
<ul>
<li>
<code>Co</code>: Conscientiousness</li>
<li>
<code>Ag</code>: Agreeableness</li>
<li>
<code>Ne</code>: Neuroticism</li>
<li>
<code>Op</code>: Openness</li>
<li>
<code>Ex</code>: Extroversion</li>
</ul>
<ol start="5" type="1">
<li><p>Create a level 2 heading titled “Overview”. Underneath this heading, write a short summary of what the data set contains (scores on a 5-factor personality questionnaire) and what each of the variables means (you can use the information from the <a href="https://psyteachr.github.io/ads-v3/data/personality_scores.json">personality_scores.json</a> codebook).</p></li>
<li><p>Create a visualisation with an appropriate plot style for each question below:</p></li>
</ol>
<ul>
<li>What does the distribution of scores look like for Agreeableness (<code>Ag</code>)?</li>
<li>Are Extraversion (<code>Ex</code>) and Openness (<code>Op</code>) correlated?</li>
</ul>
<ol start="7" type="1">
<li><p>Duplicate the code for your first plot and create the same for each of the five personality factors. Combine these 5 plots into a single figure.</p></li>
<li><p>Write a short summary that interprets the data shown in the plots - it’s not enough just to present visualisations, effective reports will also help the reader understand the conclusions they should draw from the plots you’ve presented. Organise your report so that the plots are shown <strong>after</strong> the text summary.</p></li>
<li><p>Edit the YAML header of your quarto document so that your rendered report does not show any code, messages, or warnings.</p></li>
<li><p>Pick one plot above and make a new version. Adjust the visual aesthetics to make it look as bad and as difficult to read as possible. Save the plot as a PNG image then post this plot to the week 3 thread on Teams and explain why it is so bad. Include the code in your post.</p></li>
</ol>
</div>
</div>
</section><section id="sec-glossary-viz" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="sec-glossary-viz">Glossary</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/a#argument" class="glossary" target="_blank">argument</a></td>
<td style="text-align: left;">A variable that provides input to a function.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/c#character" class="glossary" target="_blank">character</a></td>
<td style="text-align: left;">A data type representing strings of text.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/c#continuous" class="glossary" target="_blank">continuous</a></td>
<td style="text-align: left;">Data that can take on any values between other existing values.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/d#default-value" class="glossary" target="_blank">default-value</a></td>
<td style="text-align: left;">A value that a function uses for an argument if it is skipped.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/d#double" class="glossary" target="_blank">double</a></td>
<td style="text-align: left;">A data type representing a real decimal number</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/g#geom" class="glossary" target="_blank">geom</a></td>
<td style="text-align: left;">The geometric style in which data are displayed, such as boxplot, density, or histogram.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/m#median" class="glossary" target="_blank">median</a></td>
<td style="text-align: left;">The middle number in a distribution where half of the values are larger and half are smaller.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/o#outlier" class="glossary" target="_blank">outlier</a></td>
<td style="text-align: left;">A data point that is extremely distant from most of the other data points</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/r#render" class="glossary" target="_blank">render</a></td>
<td style="text-align: left;">To create a file (usually an image or PDF) or widget from source code</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://psyteachr.github.io/glossary/v#vector" class="glossary" target="_blank">vector</a></td>
<td style="text-align: left;">A type of data structure that collects values with the same data type, like T/F values, numbers, or strings.</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="sec-resources-viz" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="sec-resources-viz">Further Resources</h2>
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot2 cheat sheet</a></li>
<li>
<a href="https://psyteachr.github.io/introdataviz/">Data visualisation using R, for researchers who don’t use R</a> <span class="citation" data-cites="nordmann_2021">(<a href="app-referencing.html#ref-nordmann_2021" role="doc-biblioref">Nordmann et al., 2021</a>)</span>
</li>
<li>
<a href="https://r4ds.hadley.nz/data-visualize">Chapter 1: Data Visualisation</a> of <em>R for Data Science</em>
</li>
<li><a href="https://lizharedogs.github.io/RLadiesNYAltText">Writing Meaningful Alt Texts for Data Visualizations in R</a></li>
<li><a href="https://ggplot2.tidyverse.org/articles/">ggplot2 FAQs</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/">ggplot2 documentation</a></li>
<li><a href="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0">ggplot2 version 4.0.0 changes</a></li>
<li>
<a href="https://psyteachr.github.io/hack-your-data/">Hack Your Data Beautiful</a> workshop by University of Glasgow postgraduate students</li>
<li>
<a href="http://r4ds.had.co.nz/graphics-for-communication.html">Chapter 28: Graphics for communication</a> of <em>R for Data Science</em>
</li>
<li>
<a href="https://gganimate.com/">gganimate</a>: A package for making animated plots</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-nordmann_2021" class="csl-entry" role="listitem">
Nordmann, E., McAleer, P., Toivo, W., Paterson, H., &amp; DeBruine, L. M. (2021). <em>Data visualisation using <span>R</span>, for researchers who don’t use <span>R</span></em>. PsyArXiv. <a href="https://doi.org/10.31234/osf.io/4huvw">https://doi.org/10.31234/osf.io/4huvw</a>
</div>
</div>
</section></main><!-- /main --><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-reports.html" class="pagination-link" aria-label="Quarto Reports">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quarto Reports</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-summary.html" class="pagination-link" aria-label="Data Summaries">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Summaries</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>CC-BY 2024, psyTeachR</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>